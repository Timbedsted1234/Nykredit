/***************************************************
	DESC: 	Bankcrfm load to CAS 
	NAME:	load_bankcrfm.sas
****************************************************/

cas;
caslib _all_ assign;


%csbinit;
%dabt_load_unload_lib_all_tbl_cas(input_caslib=bankcrfm);
%dabt_load_unload_lib_all_tbl_cas(input_caslib=rm_ctrl);
%dabt_load_unload_lib_all_tbl_cas(input_caslib=rm_mdl);


Cas;
Caslib  _all_ assign;


PROC SQL ;
Create table work.IND_CUSTOMER_DIM as
SELECT                  
                ANNUAL_INCOME_AMT               ,
                ASSET_OTHER_AMT       ,
                BANKRUPTCY_FILED_DT               ,
                BANKRUPTCY_STATUS_CD          ,
                BILL_PAY_SERVICE_FLG ,
                BIRTH_DT            ,
                BUSINESS_NATURE_CD ,
                CHILDREN_CNT ,
                CURRENT_ADDRESS_START_DT ,
                CURRENT_COUNTRY_START_DT ,
                CURRENT_EMP_START_DT          ,
                CUSTOMER_ACTIVE_CD ,
                CUSTOMER_CITY_NM   ,
                CUSTOMER_CLASS_CD  ,
                CUSTOMER_COUNTRY_CD          ,
                CUSTOMER_ID  ,
                CUSTOMER_LIFECYCLE_CD          ,
                CUSTOMER_POSTAL_CD              ,
                CUSTOMER_RK ,
                CUSTOMER_RK as CUSTOMER_RK2         ,
                CUSTOMER_SK ,
                CUSTOMER_STATE_REGION_CD ,
                CUSTOMER_TYPE_CD    ,
                EDUCATION_LEVEL_CD ,
                ELDEST_CHILD_BIRTH_DT            ,
                EMPLOYEE_FLG ,
                EMPLOYERS_CNT             ,
                EMPLOYMENT_POSITION_STATUS_CD   ,
                EMPLOYMENT_START_DT           ,
                EMPLOYMENT_STATUS_CD        ,
                EMPLOYMENT_YEARS_CNT         ,
                EVER_IN_COLLECTION_FLG         ,
                EXTERNAL_CREDIT_RATING1_CD              ,
                EXTERNAL_CREDIT_RATING2_CD              ,
                FIRST_ACCOUNT_OPEN_DT        ,
                FIRST_ACCOUNT_TYPE_CD          ,
                GENDER_CD       ,
                HHOLD_RK          ,
                INCOME_CATEGORY_CD              ,
                INDUSTRY_CD   ,
                INTERNAL_CREDIT_RATING_CD ,
                LEGAL_JUDGEMENT_FLG             ,
                LIABILITY_OTHER_AMT ,
                LIABILITY_REAL_ESTATE_AMT    ,
                LIQUID_ASSETS_AMT     ,
                LIQUID_NET_WORTH_AMT         ,
                MARITAL_STATUS_CD   ,
                MONTHLY_ALIMONY_AMT         ,
                MONTHLY_BUSINESS_INCOME_AMT      ,
                MONTHLY_CHILD_ALLOW_AMT ,
                MONTHLY_CHILD_SUPPORT_AMT           ,
                ANNUAL_INCOME_AMT/12 as MONTHLY_INCOME_AMT              ,
                MONTHLY_INVESTMENT_AMT  ,
                MONTHLY_OTHER_CHARGE_AMT            ,
                MONTHLY_OTHER_INCOME_AMT           ,
                MONTHLY_PRI_INCOME_SOURCE_CD    ,
                MONTHLY_RENTAL_AMT             ,
                MONTHLY_RENTAL_INCOME_AMT          ,
                MONTHLY_REPAYMENT_AMT   ,
                MONTHLY_REPAYMENT_OTHERS_AMT ,
                MONTHLY_REPLACEMENT_INCOME_AMT            ,
                MONTHLY_SALARY_INCOME_AMT          ,
                ((ANNUAL_INCOME_AMT/12)*0.8 ) as NET_MONTHLY_INCOME_AMT    ,
                NET_WORTH_AMT         ,
                OCCUPATION_START_DT             ,
                ORGANIZATION_TYPE_CD            ,
                OTHER_BANK_CLIENT_FLG          ,
                OTHER_CREDIT_CARDS_CNT      ,
                OWN_AUTOMOBILE_FLG             ,
                OWN_MOTORCYCLE_FLG            ,
                OWN_RESIDENCE_PROPERTY_FLG           ,
                PASSPORT_ISSUE_COUNTRY_CD               ,
                PENDING_LAWSUIT_FLG              ,
                PREFERRED_CHANNEL_CD          ,
                PRIMARY_CITIZENSHIP_COUNTRY_CD    ,
                PRIMARY_INTERNAL_ORG_RK   ,
                PROCESSED_DTTM          ,
                REAL_ESTATE_AMT        ,
                RESIDENCE_STATUS_CD ,
                RESIDENCE_STATUS_DT ,
                SECNDRY_CITIZENSHIP_COUNTRY_CD    ,
                SELF_EMPLOYMENT_FLG             ,
                STD_OCCUPATION_CD  ,
                TAX_BRACKET_CD           ,
                TAX_ID ,
                TAX_ID_TYPE_CD            ,
                TEMPORARY_EMPLOYMENT_END_DT    ,
                TOTAL_ASSET_AMT        ,
                TOTAL_DEPENDENTS_CNT           ,
                TOTAL_EMPLOYMENT_YEARS_CNT         ,
                TOTAL_LIABILITY_AMT  ,
                VALID_END_DTTM          ,
                VALID_START_DTTM      ,
                YOUNGEST_CHILD_BIRTH_DT    
from                      
bankcrfm.CUSTOMER_DIM table0;                          
quit;                       


data bankcrfm.IND_CUSTOMER_DIM (promote=yes);
set work.IND_CUSTOMER_DIM;
run;

PROC SQL ;
Create table work.IND_ACCOUNT_DIM as
SELECT
table0.ACCOUNT_RK AS DIR_2 LABEL='ACCOUNT_RK',
table0.PRIMARY_CUSTOMER_RK AS DIR_3 LABEL='CUSTOMER_RK',
table0.ACCOUNT_ID AS DIR_4 LABEL='ACCOUNT_ID' FORMAT=$32.,
table0.ACCOUNT_RK AS DIR_5 LABEL='ACCOUNT_RK2' FORMAT=12.,
table0.ACCOUNT_LIFECYCLE_STG_CD AS DIR_6 LABEL='ACCOUNT_LIFECYCLE_STG_CD' FORMAT=$3.,
table0.ACCOUNT_RENEWAL_CNT AS DIR_7 LABEL='ACCOUNT_RENEWAL_CNT' FORMAT=BEST12.,
table0.ACCOUNT_RENEWAL_TYPE_CD AS DIR_8 LABEL='ACCOUNT_RENEWAL_TYPE_CD' FORMAT=$3.,
table0.ACCOUNT_SK AS DIR_9 LABEL='ACCOUNT_SK' FORMAT=BEST12.,
table0.ACCOUNT_STATUS_CD AS DIR_10 LABEL='ACCOUNT_STATUS_CD' FORMAT=$3.,
table0.ACCOUNT_SUB_TYPE_CD AS DIR_11 LABEL='ACCOUNT_SUB_TYPE_CD' FORMAT=$3.,
table0.ACCOUNT_SUB_TYPE_DESC AS DIR_12 LABEL='ACCOUNT_SUB_TYPE_DESC' FORMAT=$100.,
table0.ACCOUNT_TYPE_CD AS DIR_13 LABEL='ACCOUNT_TYPE_CD' FORMAT=$3.,
table0.ACCOUNT_TYPE_DESC AS DIR_14 LABEL='ACCOUNT_TYPE_DESC' FORMAT=$100.,
table0.ACCT_HOLDERS_CNT AS DIR_15 LABEL='ACCT_HOLDERS_CNT' FORMAT=BEST12.,
table0.ACTUAL_ACCOUNT_OPENING_AMT AS DIR_16 LABEL='ACTUAL_ACCOUNT_OPENING_AMT' FORMAT=NLNUM18.5,
table0.ACTUAL_ADVANCE_AMT AS DIR_17 LABEL='ACTUAL_ADVANCE_AMT' FORMAT=NLNUM18.5,
table0.ADDITIONAL_CARD_CNT AS DIR_18 LABEL='ADDITIONAL_CARD_CNT' FORMAT=BEST12.,
table0.ALLOW_OVERDRAFT_FLG AS DIR_19 LABEL='ALLOW_OVERDRAFT_FLG' FORMAT=$1.,
table0.ANNUAL_FEES_AMT AS DIR_20 LABEL='ANNUAL_FEES_AMT' FORMAT=NLNUM18.5,
table0.APPLICATION_RK AS DIR_21 LABEL='APPLICATION_RK' FORMAT=BEST12.,
table0.APPROVED_AMT AS DIR_22 LABEL='APPROVED_AMT' FORMAT=NLNUM18.5,
table0.BROKER_FLG AS DIR_23 LABEL='BROKER_FLG' FORMAT=$1.,
table0.CALLABLE_FACILITY_USED_FLG AS DIR_24 LABEL='CALLABLE_FACILITY_USED_FLG' FORMAT=$1.,
table0.CASH_BACK_FLG AS DIR_25 LABEL='CASH_BACK_FLG' FORMAT=$1.,
table0.CASH_BACK_PCT AS DIR_26 LABEL='CASH_BACK_PCT' FORMAT=NLNUM9.4,
table0.CASH_LIMIT_AMT AS DIR_27 LABEL='CASH_LIMIT_AMT' FORMAT=NLNUM18.5,
table0.CHARGE_OFF_AMT AS DIR_28 LABEL='CHARGE_OFF_AMT' FORMAT=NLNUM18.5,
table0.CHARGE_OFF_FLG AS DIR_29 LABEL='CHARGE_OFF_FLG' FORMAT=$1.,
table0.CHECKING_MAIN_FLG AS DIR_30 LABEL='CHECKING_MAIN_FLG' FORMAT=$1.,
table0.CHECK_BOOK_FLG AS DIR_31 LABEL='CHECK_BOOK_FLG' FORMAT=$1.,
table0.CLOSE_REASON_CD AS DIR_32 LABEL='CLOSE_REASON_CD' FORMAT=$3.,
table0.CLOSING_COST_AMT AS DIR_33 LABEL='CLOSING_COST_AMT' FORMAT=NLNUM18.5,
table0.COLLATERAL_AMT AS DIR_34 LABEL='COLLATERAL_AMT' FORMAT=NLNUM18.5,
table0.COLLATERAL_CD AS DIR_35 LABEL='COLLATERAL_CD' FORMAT=$3.,
table0.COLLECTIONS_STATUS_CD AS DIR_36 LABEL='COLLECTIONS_STATUS_CD' FORMAT=$3.,
table0.CREATED_BY AS DIR_37 LABEL='CREATED_BY' FORMAT=$20.,
( table0.CREATED_DTTM ) AS DIR_38 LABEL='CREATED_DTTM' FORMAT=NLDATM21.,
table0.CREDIT_FACILITY_RK AS DIR_39 LABEL='CREDIT_FACILITY_RK' FORMAT=BEST12.,
table0.CURRENCY_CD AS DIR_40 LABEL='CURRENCY_CD' FORMAT=$3.,
table0.CURRENT_LIMIT_AMT AS DIR_41 LABEL='CURRENT_LIMIT_AMT' FORMAT=NLNUM18.5,
table0.DIRECT_DEBITS_CNT AS DIR_42 LABEL='DIRECT_DEBITS_CNT' FORMAT=BEST12.,
table0.DISBURSEMENT_TYPE_CD AS DIR_43 LABEL='DISBURSEMENT_TYPE_CD' FORMAT=$3.,
table0.DO_NOT_CONTACT_FLG AS DIR_44 LABEL='DO_NOT_CONTACT_FLG' FORMAT=$1.,
table0.DOCUMENTATION_TYPE_CD AS DIR_45 LABEL='DOCUMENTATION_TYPE_CD' FORMAT=$3.,
table0.DOWNPAYMENT_AMT AS DIR_46 LABEL='DOWNPAYMENT_AMT' FORMAT=NLNUM18.5,
table0.FINANCE_CHARGE_FLG AS DIR_47 LABEL='FINANCE_CHARGE_FLG' FORMAT=$1.,
table0.GRACE_PERIOD_DAYS_CNT AS DIR_48 LABEL='GRACE_PERIOD_DAYS_CNT' FORMAT=BEST12.,
table0.GUARANTEE_AMT AS DIR_49 LABEL='GUARANTEE_AMT' FORMAT=NLNUM18.5,
table0.GUARANTORS_CNT AS DIR_50 LABEL='GUARANTORS_CNT' FORMAT=BEST12.,
table0.HOME_STATUS_CD AS DIR_51 LABEL='HOME_STATUS_CD' FORMAT=$3.,
table0.HONEYMOON_PERIOD_FLG AS DIR_52 LABEL='HONEYMOON_PERIOD_FLG' FORMAT=$1.,
table0.IMPROVEMENTS_ALLOCATION_AMT AS DIR_53 LABEL='IMPROVEMENTS_ALLOCATION_AMT' FORMAT=NLNUM18.5,
table0.INDIVIDUAL_ORGANIZATION_CD AS DIR_54 LABEL='INDIVIDUAL_ORGANIZATION_CD' FORMAT=$3.,
table0.INITIAL_LIMIT_AMT AS DIR_55 LABEL='INITIAL_LIMIT_AMT' FORMAT=NLNUM18.5,
table0.INTEREST_PAYOUT_FLG AS DIR_56 LABEL='INTEREST_PAYOUT_FLG' FORMAT=$1.,
table0.LIEN_INDICATOR_FLG AS DIR_57 LABEL='LIEN_INDICATOR_FLG' FORMAT=$1.,
table0.LINKED_ACCOUNT_FLG AS DIR_58 LABEL='LINKED_ACCOUNT_FLG' FORMAT=$1.,
table0.LINKED_DEP_ACCT_FLG AS DIR_59 LABEL='LINKED_DEP_ACCT_FLG' FORMAT=$1.,
table0.MIN_ACCOUNT_OPENING_AMT AS DIR_60 LABEL='MIN_ACCOUNT_OPENING_AMT' FORMAT=NLNUM18.5,
table0.MIN_PAYMENT_FLG AS DIR_61 LABEL='MIN_PAYMENT_FLG' FORMAT=$1.,
table0.MIN_REDRAW_AMT AS DIR_62 LABEL='MIN_REDRAW_AMT' FORMAT=NLNUM18.5,
table0.MORTGAGE_INSURED_FLG AS DIR_63 LABEL='MORTGAGE_INSURED_FLG' FORMAT=$1.,
table0.MORTGAGE_OPEN_TO_BUY_AMT AS DIR_64 LABEL='MORTGAGE_OPEN_TO_BUY_AMT' FORMAT=NLNUM18.5,
table0.MULTI_RATE_FLG AS DIR_65 LABEL='MULTI_RATE_FLG' FORMAT=$1.,
table0.NOMINEES_CNT AS DIR_66 LABEL='NOMINEES_CNT' FORMAT=BEST12.,
table0.OFFSET_ACCOUNT_FLG AS DIR_67 LABEL='OFFSET_ACCOUNT_FLG' FORMAT=$1.,
table0.OPENING_CAMPAIGN_CD AS DIR_68 LABEL='OPENING_CAMPAIGN_CD' FORMAT=$30.,
table0.OPENING_CHANNEL_CD AS DIR_69 LABEL='OPENING_CHANNEL_CD' FORMAT=$3.,
table0.OVERDRAFT_LIMIT_AMT AS DIR_70 LABEL='OVERDRAFT_LIMIT_AMT' FORMAT=NLNUM18.5,
table0.OWNED_BY_INTERNAL_ORG_RK AS DIR_71 LABEL='OWNED_BY_INTERNAL_ORG_RK' FORMAT=BEST12.,
table0.PAYMENT_DAY_OF_MONTH AS DIR_72 LABEL='PAYMENT_DAY_OF_MONTH' FORMAT=BEST12.,
table0.PAYMENT_FREQUENCY_CD AS DIR_73 LABEL='PAYMENT_FREQUENCY_CD' FORMAT=$3.,
table0.PAYMENT_INSURED_FLG AS DIR_74 LABEL='PAYMENT_INSURED_FLG' FORMAT=$1.,
table0.PAYMENT_MODE_CD AS DIR_75 LABEL='PAYMENT_MODE_CD' FORMAT=$3.,
table0.PORTABILITY_FLG AS DIR_76 LABEL='PORTABILITY_FLG' FORMAT=$1.,
table0.PRIMARY_CUSTOMER_RK AS DIR_77 LABEL='PRIMARY_CUSTOMER_RK' FORMAT=BEST12.,
table0.PRIMARY_PRODUCT_RK AS DIR_78 LABEL='PRIMARY_PRODUCT_RK' FORMAT=BEST12.,
( table0.PROCESSED_DTTM ) AS DIR_79 LABEL='PROCESSED_DTTM' FORMAT=NLDATM21.,
table0.PROVISIONAL_CREDIT_LIMIT_AMT AS DIR_80 LABEL='PROVISIONAL_CREDIT_LIMIT_AMT' FORMAT=NLNUM18.5,
table0.PURPOSE_CD AS DIR_81 LABEL='PURPOSE_CD' FORMAT=$3.,
table0.REDRAW_FLG AS DIR_82 LABEL='REDRAW_FLG' FORMAT=$1.,
table0.REGULAR_PERIODIC_PAYMENT_AMT AS DIR_83 LABEL='REGULAR_PERIODIC_PAYMENT_AMT' FORMAT=NLNUM18.5,
table0.REPAYMENT_HOLIDAY_FLG AS DIR_84 LABEL='REPAYMENT_HOLIDAY_FLG' FORMAT=$1.,
table0.REQUIRED_MIN_BALANCE_AMT AS DIR_85 LABEL='REQUIRED_MIN_BALANCE_AMT' FORMAT=NLNUM18.5,
table0.SAFE_DEPOSIT_FLG AS DIR_86 LABEL='SAFE_DEPOSIT_FLG' FORMAT=$1.,
table0.SECURITY_CD AS DIR_87 LABEL='SECURITY_CD' FORMAT=$3.,
table0.SECURITY_DEPOSIT_AMT AS DIR_88 LABEL='SECURITY_DEPOSIT_AMT' FORMAT=NLNUM18.5,
table0.SECURITY_DEPOSIT_REFUND_AMT AS DIR_89 LABEL='SECURITY_DEPOSIT_REFUND_AMT' FORMAT=NLNUM18.5,
table0.SENIORITY_CD AS DIR_90 LABEL='SENIORITY_CD' FORMAT=$3.,
table0.SIGNATORIES_CNT AS DIR_91 LABEL='SIGNATORIES_CNT' FORMAT=BEST12.,
table0.SOURCE_SYSTEM_CD AS DIR_92 LABEL='SOURCE_SYSTEM_CD' FORMAT=$3.,
table0.SPECIAL_INTEREST_RT AS DIR_93 LABEL='SPECIAL_INTEREST_RT' FORMAT=NLNUM9.4,
table0.SPECIAL_RATE_TYPE_CD AS DIR_94 LABEL='SPECIAL_RATE_TYPE_CD' FORMAT=$3.,
table0.SPLIT_LOAN_FLG AS DIR_95 LABEL='SPLIT_LOAN_FLG' FORMAT=$1.,
table0.STANDING_ORDERS_CNT AS DIR_96 LABEL='STANDING_ORDERS_CNT' FORMAT=BEST12.,
table0.STATEMENT_FREQUENCY_CD AS DIR_97 LABEL='STATEMENT_FREQUENCY_CD' FORMAT=$3.,
table0.STEP_UP_FACILITY_USED_FLG AS DIR_98 LABEL='STEP_UP_FACILITY_USED_FLG' FORMAT=$1.,
( table0.VALID_END_DTTM ) AS DIR_99 LABEL='VALID_END_DTTM' FORMAT=NLDATM21.,
( table0.VALID_START_DTTM ) AS DIR_100 LABEL='VALID_START_DTTM' FORMAT=NLDATM21.,
( table0.CARD_EXPIRATION_DT ) AS DIR_101 LABEL='CARD_EXPIRATION_DT' FORMAT=NLDATM21.,
( table0.CARD_ISSUE_DT ) AS DIR_102 LABEL='CARD_ISSUE_DT' FORMAT=NLDATM21.,
( table0.CARD_REISSUE_DT ) AS DIR_103 LABEL='CARD_REISSUE_DT' FORMAT=NLDATM21.,
( table0.CHARGE_OFF_DT ) AS DIR_104 LABEL='CHARGE_OFF_DT' FORMAT=NLDATM21.,
( table0.CLOSE_DT ) AS DIR_105 LABEL='CLOSE_DT' FORMAT=NLDATM21.,
( table0.CURRENT_LIMIT_DT ) AS DIR_106 LABEL='CURRENT_LIMIT_DT' FORMAT=NLDATM21.,
( table0.HONEYMOON_END_DT ) AS DIR_107 LABEL='HONEYMOON_END_DT' FORMAT=NLDATM21.,
( table0.HONEYMOON_START_DT ) AS DIR_108 LABEL='HONEYMOON_START_DT' FORMAT=NLDATM21.,
( table0.OVERDRAFT_LIMIT_DT ) AS DIR_109 LABEL='OVERDRAFT_LIMIT_DT' FORMAT=NLDATM21.,
( table0.OPEN_DT ) AS DIR_110 LABEL='OPEN_DT' FORMAT=NLDATM21.,
( table0.PROV_CREDIT_LIMIT_CLOSE_DT ) AS DIR_111 LABEL='PROV_CREDIT_LIMIT_CLOSE_DT' FORMAT=NLDATM21.,
( table0.PROV_CREDIT_LIMIT_OPEN_DT ) AS DIR_112 LABEL='PROV_CREDIT_LIMIT_OPEN_DT' FORMAT=NLDATM21.,
( table0.REGISTER_ONLINE_DT ) AS DIR_113 LABEL='REGISTER_ONLINE_DT' FORMAT=NLDATM21.,
( table0.REPAYMENT_HOLIDAY_END_DT ) AS DIR_114 LABEL='REPAYMENT_HOLIDAY_END_DT' FORMAT=NLDATM21.,
( table0.REPAYMENT_HOLIDAY_START_DT ) AS DIR_115 LABEL='REPAYMENT_HOLIDAY_START_DT' FORMAT=NLDATM21.,
( table0.SPECIAL_RATE_END_DT ) AS DIR_116 LABEL='SPECIAL_RATE_END_DT' FORMAT=NLDATM21.,
( table0.SPECIAL_RATE_START_DT ) AS DIR_117 LABEL='SPECIAL_RATE_START_DT' FORMAT=NLDATM21.
FROM
bankcrfm.ACCOUNT_DIM table0;
quit;

data bankcrfm.ind_account_dim(promote=yes);
set work.ind_account_dim;
run;

