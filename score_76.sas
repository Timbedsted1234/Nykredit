data &m_output_table_nm;
set &m_scoring_abt_table_nm;

*------------------------------------------------------------*;
* DABT JUDGEMENTAL SCORE CODE;
*------------------------------------------------------------*;

EM_SCORECARD_POINTS = 0;

*------------------------------------------------------------*;
* Variable: EXPERIAN_GNS90;
*------------------------------------------------------------*;
if  NOT MISSING(EXPERIAN_GNS90) then do;
if EXPERIAN_GNS90>=0 and EXPERIAN_GNS90<=0 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -156791 ;
GRP_EXPERIAN_GNS90 = 23527;
end;

else if EXPERIAN_GNS90>0 and EXPERIAN_GNS90<1 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 4691670 ;
GRP_EXPERIAN_GNS90 = 23528;
end;

else if EXPERIAN_GNS90 >=1 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7115900 ;
GRP_EXPERIAN_GNS90 = 23529;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -156791 ;
GRP_EXPERIAN_GNS90 = 23527;
end;
end;
else if MISSING(EXPERIAN_GNS90) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -156791 ;
GRP_EXPERIAN_GNS90 = 23527;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -156791 ;
GRP_EXPERIAN_GNS90 = 23527;
end;


*------------------------------------------------------------*;
* Variable: RYKKER_123;
*------------------------------------------------------------*;
if  NOT MISSING(RYKKER_123) then do;
if RYKKER_123 in (1) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 11816122 ;
GRP_RYKKER_123 = 23538;
end;

else if RYKKER_123 in (2) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 9417091 ;
GRP_RYKKER_123 = 23539;
end;

else if RYKKER_123 in (3) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 4619029 ;
GRP_RYKKER_123 = 23540;
end;

else if RYKKER_123 in (4) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -179032 ;
GRP_RYKKER_123 = 23541;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -179032 ;
GRP_RYKKER_123 = 23541;
end;
end;
else if MISSING(RYKKER_123) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -179032 ;
GRP_RYKKER_123 = 23541;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -179032 ;
GRP_RYKKER_123 = 23541;
end;


*------------------------------------------------------------*;
* Variable: DEPOT_FRIEMIDL_SUM_MEAN_6MND;
*------------------------------------------------------------*;
if  NOT MISSING(DEPOT_FRIEMIDL_SUM_MEAN_6MND) then do;
if DEPOT_FRIEMIDL_SUM_MEAN_6MND <=0 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 184899 ;
GRP_DEPOT_FRIEMIDL_SUM_MEAN_6MND = 23523;
end;

else if DEPOT_FRIEMIDL_SUM_MEAN_6MND>0 and DEPOT_FRIEMIDL_SUM_MEAN_6MND<=100000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -4320700 ;
GRP_DEPOT_FRIEMIDL_SUM_MEAN_6MND = 23524;
end;

else if DEPOT_FRIEMIDL_SUM_MEAN_6MND>100000 and DEPOT_FRIEMIDL_SUM_MEAN_6MND<=500000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -8826300 ;
GRP_DEPOT_FRIEMIDL_SUM_MEAN_6MND = 23525;
end;

else if DEPOT_FRIEMIDL_SUM_MEAN_6MND >500000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -17837498 ;
GRP_DEPOT_FRIEMIDL_SUM_MEAN_6MND = 23526;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 184899 ;
GRP_DEPOT_FRIEMIDL_SUM_MEAN_6MND = 23523;
end;
end;
else if MISSING(DEPOT_FRIEMIDL_SUM_MEAN_6MND) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 184899 ;
GRP_DEPOT_FRIEMIDL_SUM_MEAN_6MND = 23523;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 184899 ;
GRP_DEPOT_FRIEMIDL_SUM_MEAN_6MND = 23523;
end;


*------------------------------------------------------------*;
* Variable: OVERTRK_MAX_AKT_MAX_6MND;
*------------------------------------------------------------*;
if  NOT MISSING(OVERTRK_MAX_AKT_MAX_6MND) then do;
if OVERTRK_MAX_AKT_MAX_6MND <30 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1061437 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 23534;
end;

else if OVERTRK_MAX_AKT_MAX_6MND>=30 and OVERTRK_MAX_AKT_MAX_6MND<60 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 12272865 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 23535;
end;

else if OVERTRK_MAX_AKT_MAX_6MND>=60 and OVERTRK_MAX_AKT_MAX_6MND<90 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 25607167 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 23536;
end;

else if OVERTRK_MAX_AKT_MAX_6MND >=90 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 38941469 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 23537;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1061437 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 23534;
end;
end;
else if MISSING(OVERTRK_MAX_AKT_MAX_6MND) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1061437 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 23534;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1061437 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 23534;
end;


*------------------------------------------------------------*;
* Variable: INDLAAN_SUM_MEAN_6MND;
*------------------------------------------------------------*;
if  NOT MISSING(INDLAAN_SUM_MEAN_6MND) then do;
if INDLAAN_SUM_MEAN_6MND <50000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7960381 ;
GRP_INDLAAN_SUM_MEAN_6MND = 23530;
end;

else if INDLAAN_SUM_MEAN_6MND>=50000 and INDLAAN_SUM_MEAN_6MND<250000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 769205 ;
GRP_INDLAAN_SUM_MEAN_6MND = 23531;
end;

else if INDLAAN_SUM_MEAN_6MND>=250000 and INDLAAN_SUM_MEAN_6MND<750000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -6421970 ;
GRP_INDLAAN_SUM_MEAN_6MND = 23532;
end;

else if INDLAAN_SUM_MEAN_6MND >=750000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -20804320 ;
GRP_INDLAAN_SUM_MEAN_6MND = 23533;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7960381 ;
GRP_INDLAAN_SUM_MEAN_6MND = 23530;
end;
end;
else if MISSING(INDLAAN_SUM_MEAN_6MND) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7960381 ;
GRP_INDLAAN_SUM_MEAN_6MND = 23530;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7960381 ;
GRP_INDLAAN_SUM_MEAN_6MND = 23530;
end;

SCORECARD_POINTS = EM_SCORECARD_POINTS;
run;
