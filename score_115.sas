data &m_output_table_nm;
set &m_scoring_abt_table_nm;

*------------------------------------------------------------*;
* DABT JUDGEMENTAL SCORE CODE;
*------------------------------------------------------------*;

EM_SCORECARD_POINTS = 0;

*------------------------------------------------------------*;
* Variable: INDLAAN_SUM_MEAN_6MND;
*------------------------------------------------------------*;
if  NOT MISSING(INDLAAN_SUM_MEAN_6MND) then do;
if INDLAAN_SUM_MEAN_6MND <10000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7190144 ;
GRP_INDLAAN_SUM_MEAN_6MND = 32718;
end;

else if INDLAAN_SUM_MEAN_6MND>=10000 and INDLAAN_SUM_MEAN_6MND<50000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1738462 ;
GRP_INDLAAN_SUM_MEAN_6MND = 32719;
end;

else if INDLAAN_SUM_MEAN_6MND>=50000 and INDLAAN_SUM_MEAN_6MND<250000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -10667069 ;
GRP_INDLAAN_SUM_MEAN_6MND = 32720;
end;

else if INDLAAN_SUM_MEAN_6MND >=250000 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -28524282 ;
GRP_INDLAAN_SUM_MEAN_6MND = 32721;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7190144 ;
GRP_INDLAAN_SUM_MEAN_6MND = 32718;
end;
end;
else if MISSING(INDLAAN_SUM_MEAN_6MND) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7190144 ;
GRP_INDLAAN_SUM_MEAN_6MND = 32718;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 7190144 ;
GRP_INDLAAN_SUM_MEAN_6MND = 32718;
end;


*------------------------------------------------------------*;
* Variable: EXPERIAN_GNS90;
*------------------------------------------------------------*;
if  NOT MISSING(EXPERIAN_GNS90) then do;
if EXPERIAN_GNS90>0 and EXPERIAN_GNS90<1 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 12106355 ;
GRP_EXPERIAN_GNS90 = 32715;
end;

else if EXPERIAN_GNS90 >=1 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 18372093 ;
GRP_EXPERIAN_GNS90 = 32716;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -425121 ;
GRP_EXPERIAN_GNS90 = 32717;
end;
end;
else if MISSING(EXPERIAN_GNS90) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -425121 ;
GRP_EXPERIAN_GNS90 = 32717;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -425121 ;
GRP_EXPERIAN_GNS90 = 32717;
end;


*------------------------------------------------------------*;
* Variable: RYKKER_123;
*------------------------------------------------------------*;
if  NOT MISSING(RYKKER_123) then do;
if RYKKER_123 in (1) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 11886076 ;
GRP_RYKKER_123 = 32726;
end;

else if RYKKER_123 in (2) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 9469575 ;
GRP_RYKKER_123 = 32727;
end;

else if RYKKER_123 in (3) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 4636574 ;
GRP_RYKKER_123 = 32728;
end;

else if RYKKER_123 in (4) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -196426 ;
GRP_RYKKER_123 = 32729;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 0 ;
GRP_RYKKER_123 = 32730;
end;
end;
else if MISSING(RYKKER_123) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 0 ;
GRP_RYKKER_123 = 32730;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 0 ;
GRP_RYKKER_123 = 32730;
end;


*------------------------------------------------------------*;
* Variable: OVERTRK_MAX_AKT_MAX_6MND;
*------------------------------------------------------------*;
if  NOT MISSING(OVERTRK_MAX_AKT_MAX_6MND) then do;
if OVERTRK_MAX_AKT_MAX_6MND <30 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1150284 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 32722;
end;

else if OVERTRK_MAX_AKT_MAX_6MND>=30 and OVERTRK_MAX_AKT_MAX_6MND<60 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 11796525 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 32723;
end;

else if OVERTRK_MAX_AKT_MAX_6MND>=60 and OVERTRK_MAX_AKT_MAX_6MND<90 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 24743334 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 32724;
end;

else if OVERTRK_MAX_AKT_MAX_6MND >=90 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 37690142 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 32725;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1150284 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 32722;
end;
end;
else if MISSING(OVERTRK_MAX_AKT_MAX_6MND) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1150284 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 32722;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -1150284 ;
GRP_OVERTRK_MAX_AKT_MAX_6MND = 32722;
end;


*------------------------------------------------------------*;
* Variable: STIFT_ALDER;
*------------------------------------------------------------*;
if  NOT MISSING(STIFT_ALDER) then do;
if STIFT_ALDER <=24 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 14729549 ;
GRP_STIFT_ALDER = 32731;
end;

else if STIFT_ALDER>24 and STIFT_ALDER<=60 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 8440662 ;
GRP_STIFT_ALDER = 32732;
end;

else if STIFT_ALDER>60 and STIFT_ALDER<=120 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 2151774 ;
GRP_STIFT_ALDER = 32733;
end;

else if STIFT_ALDER >120 then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + -4137113 ;
GRP_STIFT_ALDER = 32734;
end;

else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 14729549 ;
GRP_STIFT_ALDER = 32731;
end;
end;
else if MISSING(STIFT_ALDER) then do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 14729549 ;
GRP_STIFT_ALDER = 32731;
end;
else do;
EM_SCORECARD_POINTS = EM_SCORECARD_POINTS + 14729549 ;
GRP_STIFT_ALDER = 32731;
end;

SCORECARD_POINTS = EM_SCORECARD_POINTS;
run;
